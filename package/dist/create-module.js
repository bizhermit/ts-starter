"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const path_1=__importDefault(require("path")),common_1=require("./common"),createModule=async(e,t)=>{const{appName:a}=(0,common_1.analyzeArgsOptions)(e,t),o="__srcDir__",n="src",c="__stgDir__",i=".stg",r="__packageDir__",s="package",m=await(0,common_1.getPackageJson)(e,{appName:a,license:"MIT"});m.scripts={clean:"npx rimraf package",license:"npx rimraf CREDIT && npx license -o CREDIT --returnError",test:"npx jest --roots test --json --outputFile=test/results.json",prebuild:"npm run license && npm run clean",build:"npx tsc -p src/tsconfig.json && npx minifier package",postbuild:"npx npm-package-utils pack && npm run test"},await(0,common_1.savePackageJson)(e,m),(0,common_1.installLibs)(e,[],["@bizhermit/license","@bizhermit/minifier","@bizhermit/npm-package-utils","jest","rimraf","typescript"]),await(0,common_1.generateTemplate)(e,"module"),await(0,common_1.replaceTexts)(path_1.default.join(e,".gitignore"),[{anchor:o,text:n},{anchor:c,text:i}]),await(0,common_1.replaceTexts)(path_1.default.join(e,n,"tsconfig.json"),[{anchor:c,text:i},{anchor:r,text:s}]),await(0,common_1.replaceTexts)(path_1.default.join(e,"test/test.js"),[{anchor:r,text:s}]),(0,common_1.npmPackageInit)(e);const p=await(0,common_1.getPackageJson)(path_1.default.join(e,n),{preventInit:!0,...t});await(0,common_1.savePackageJson)(path_1.default.join(e,n),p),(0,common_1.installLibs)(path_1.default.join(e,n),["@bizhermit/basic-utils"],["@types/node","typescript"]),await(0,common_1.replaceTexts)(path_1.default.join(e,"README.md"),[{anchor:common_1.__appName__,text:a},{anchor:o,text:n},{anchor:c,text:i}]),await(0,common_1.generateTemplate)(e,"dev-env/module"),await(0,common_1.replaceTexts)(path_1.default.join(e,".vscode/tasks.json"),[{anchor:o,text:n},{anchor:c,text:i}]),await(0,common_1.replaceTexts)(path_1.default.join(e,".vscode/settings.json"),[{anchor:o,text:n},{anchor:c,text:i}]),await(0,common_1.replaceAppName)(path_1.default.join(e,".devcontainer/docker-compose.yml"),a),await(0,common_1.replaceTexts)(path_1.default.join(e,".devcontainer/devcontainer.json"),[{anchor:common_1.__appName__,text:a},{anchor:o,text:n},{anchor:c,text:i}])};exports.default=createModule;