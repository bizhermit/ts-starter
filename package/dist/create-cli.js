"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const path_1=__importDefault(require("path")),common_1=require("./common"),createCli=async(t,e)=>{const{appName:a}=(0,common_1.analyzeArgsOptions)(t,e),n=".dist",o="__srcDir__",i="src",c="__stgDir__",r=".stg",s="__packageDir__",m="package",p=await(0,common_1.getPackageJson)(t,{appName:a,license:"MIT"});p.scripts={clean:"npx rimraf package",license:"npx rimraf CREDIT && npx license -o CREDIT --returnError",test:"npx jest --roots test --json --outputFile=test/results.json",prebuild:"npm run license && npm run clean",build:"npx tsc -p src/tsconfig.json && npx rimraf package/bin/cli.d.ts && npx minifier package",postbuild:"npx npm-package-utils pack && npm run test",dist:"npx rimraf .dist && npm run build && npx pkg --out-path .dist --compress GZip package/bin/cli.js","dist:linux":"npm run build:exe -- --targets linux","dist:win":"npm run build:exe -- --targets win","dist:mac":"npm run build:exe -- --targets mac"},await(0,common_1.savePackageJson)(t,p),(0,common_1.installLibs)(t,[],["@bizhermit/license","@bizhermit/minifier","@bizhermit/npm-package-utils","jest","pkg","rimraf","typescript"]),await(0,common_1.generateTemplate)(t,"module"),await(0,common_1.generateTemplate)(t,"cli"),await(0,common_1.replaceTexts)(path_1.default.join(t,".gitignore"),[{anchor:o,text:i},{anchor:c,text:r},{anchor:"__distDir__",text:n}]),await(0,common_1.replaceTexts)(path_1.default.join(t,i,"tsconfig.json"),[{anchor:c,text:r},{anchor:s,text:m}]),await(0,common_1.replaceTexts)(path_1.default.join(t,"test/test.js"),[{anchor:s,text:m}]),(0,common_1.npmPackageInit)(t);const _=await(0,common_1.getPackageJson)(path_1.default.join(t,i),{preventInit:!0,...e});await(0,common_1.savePackageJson)(path_1.default.join(t,i),_),(0,common_1.installLibs)(path_1.default.join(t,i),["@bizhermit/basic-utils","@bizhermit/cli-utils"],["@types/node","typescript"]),await(0,common_1.replaceTexts)(path_1.default.join(t,"README.md"),[{anchor:common_1.__appName__,text:a},{anchor:o,text:i},{anchor:c,text:r}]),await(0,common_1.generateTemplate)(t,"dev-env/module"),await(0,common_1.replaceTexts)(path_1.default.join(t,".vscode/tasks.json"),[{anchor:o,text:i},{anchor:c,text:r}]),await(0,common_1.replaceTexts)(path_1.default.join(t,".vscode/settings.json"),[{anchor:o,text:i},{anchor:c,text:r},{anchor:s,text:m}]),await(0,common_1.replaceAppName)(path_1.default.join(t,".devcontainer/docker-compose.yml"),a),await(0,common_1.replaceTexts)(path_1.default.join(t,".devcontainer/devcontainer.json"),[{anchor:common_1.__appName__,text:a},{anchor:o,text:i},{anchor:c,text:r}])};exports.default=createCli;